FROM alpine:3.8

RUN apk --no-cache --virtual .fontsinstaller add msttcorefonts-installer fontconfig \
  && update-ms-fonts \
  && fc-cache -f \
  && apk del .fontsinstaller \
  && rm /var/cache/apk/*

ENV GDFONTPATH=/usr/share/fonts/truetype/msttcorefonts/

# Install gnuplot from source
RUN apk --update add libgd libpng libjpeg libwebp libjpeg-turbo cairo pango lua readline \
 && apk add --virtual .gnuplotbuild git gcc g++ libtool make automake autoconf cairo-dev pango-dev gd-dev lua-dev readline-dev libpng-dev libjpeg-turbo-dev libwebp-dev \
 && mkdir -p /src && cd /src \
 && git clone https://git.code.sf.net/p/gnuplot/gnuplot-main gnuplot-gnuplot-main  \
 && cd gnuplot-gnuplot-main \
 && git checkout 5.2.8
 && ./prepare \
 && ./configure \
 && make \
 && make install
